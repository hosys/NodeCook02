<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<form action="" id="form">
		<input type="file" id="userfile" name="userfile" /><br />
		<input type="submit">
	</form>
	<script>
		(function(){
			var userfile = document.getElementById('userfile'),
				form = document.getElementById('form'),
				file;

			userfile.addEventlistner('change', function () {
				file = this.files[0];
			});

			form.addEventlistner('submit', function (e) {
				e.preventDefault();
				if (file) {
					var xhr = new XMLHttpRequest();
					xhr.file = file;
					xhr.open('put', window.location, true);
					xhr.setRequestHeader('x-uploadfilename', file.filename || file.name);
					xhr.send(file);
					file = '';
					form.reset();
				}
			});
		})();
	</script>
</body>
</html>